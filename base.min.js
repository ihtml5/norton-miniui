var toString=Object.prototype.toString;var nativeSlice=Array.prototype.slice;var ebapBase=(function(){var ebapModules={};var ebapInstance=null;var isParsed=false;var winLoc=window.location;var winLocSearch=winLoc.search;var guid=0;var win=window;var commonCfg={disable:["list.id","id"],list:{key:"list",loadData:true,settings:{edit:"/info/announcement/form",add:"/info/announcement/form",del:"/info/announcement/delete?id="},openCfg:{width:400,height:300,add:{title:"新增公告信息"},edit:{title:"编辑公告信息"}}}};var config={root:window["ctx"],injectRules:{"normal":function(){rules["mixin"][0][rules.method]()},"ifelse":function(rules){if(rkFlist.mode="line-add"){rules["mixin"][0][rules.method]()}else{rules["mixin"].forEach(function(i,f){if(i>=1){f[rules.method]()}})}},"combine":function(){rules["mixin"].forEach(function(i,f){f[rules.method]()})}},uiLib:"mini",nameSpace:"ebap",enableList:{open:true,decode:true,encode:true,utils:{},lock:["get","created"]},openFilterRules:["onload","ondestroy"]};function support(libName,funcName,context){var __context=context?context:window;return(typeof __context[libName]!=="undefined")&&__context[libName][funcName]}function miniSupport(methodName,options){if(config.uiLib==="mini"&&support("mini","get")){if(methodName==="form"){return new mini.Form(options.id)}else{if(methodName==="tooltip"){return new mini.ToolTip()}}}return support(config.uiLib,methodName)}function _execute(elm,method){var _method=method;var arg=Array.prototype.slice.call(arguments,2);return elm[_method]&&elm[_method].apply(this,arg)}function _isExistTarget(elm,targetInfo){if(elm.tagName.toUpperCase()===targetInfo.tagName.toUpperCase()&&elm.className.indexOf(targetInfo.cls)!==-1||elm.id===targetInfo.id){return true}return false}function _eventProxy(proxyNode,targetInfo,callback){var proxyArgs=[].slice.call(arguments);var proxyNode=proxyNode;var targetInfo=targetInfo;var callback=callback;if(proxyArgs.length===1&&toString.call(proxyArgs[0])==="[object Object]"){proxyNode=proxyArgs[0].context;targetInfo={cls:proxyArgs[0].cls,tagName:proxyArgs[0].tagName,id:proxyArgs[0].id||""};callback=proxyArgs[0].cb}proxyNode.click(function(e){if(e.target.tagName==="A"&&targetInfo.tagName==="a"){e.preventDefault()}if(_isExistTarget(e.target,targetInfo)){targetInfo=$.extend({},targetInfo,{level:0,dom:e.target});callback(targetInfo);return undefined}$(e.target).parents(proxyNode).each(function(idx,elm){if(_isExistTarget(elm,targetInfo)){targetInfo=$.extend({},targetInfo,{level:idx+1,dom:e.target});callback(targetInfo);return false}})})}function autoInput($els,ebapparams){$els.on("input",function(event){if(event.target.value.length===0){delete ebapparams[event.target.name]}else{ebapparams[event.target.name]=event.target.value}});if(document.all){$els.each(function(){var that=this;if(this.attachEvent){this.attachEvent("onpropertychange",function(e){if(e.propertyName!="value"){return}$(that).trigger("input")})}})}}function multiChangeHandler(option,checked,key,ebapparams){var _multiKey=key;if(checked){ebapparams[_multiKey]=option[0].value}else{ebapparams[_multiKey]=""}}function setUp(func){typeof func==="function"&&func.apply(null,nativeSlice.call(arguments,1));return this}var _cacheEbapIns=null;function getParameterNames(fn){var COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;var DEFAULT_PARAMS=/=[^,]+/mg;var FAT_ARROWS=/=>.*$/mg;var code=fn.toString().replace(COMMENTS,"").replace(FAT_ARROWS,"").replace(DEFAULT_PARAMS,"");var result=code.slice(code.indexOf("(")+1,code.indexOf(")")).match(/([^\s,]+)/g);return result===null?[]:result}function getAllOptions(options){return function(){var args=nativeSlice.call(arguments);var optionsStrToArr=[];var _index=0;var result=null;if(typeof args[0]==="string"){optionsStrToArr=args[0].split(".");var oLen=optionsStrToArr.length}for(;_index<oLen;_index++){if(result){result=result[optionsStrToArr[_index]]}else{result=options[optionsStrToArr[_index]]}}return result||(args[1]?args[1]:undefined)}}var utilsPool={};var utils={actionTypes:["ebap-tbActionAdd","ebap-tbActionDelete","ebap-tbActionModify","ebap-tbActionAssign","ebap-actionType"],toggleEnable:function(obj){$.extend(config["enableList"],obj)},getAllOptions:getAllOptions,disable:function(key){var _methodName=key;if(utils[_methodName]){config.enableList.utils[_methodName]=false}},setNameSpace:function(ns){if(!ns){return}return config["nameSpace"]=typeof ns==="string"?ns:ns.toString()},setPropTrue:function(obj){if(!$.isPlainObject(obj)){return}for(var u in obj){if(obj.hasOwnProperty(u)&&typeof obj[u]=="function"&&$.inArray(u,config.enableList.lock)==-1){config.enableList.utils[u]=true}}},getInstance:function(options,type){var cacheInstance=null;if(typeof options==="string"){var options={id:options}}if(type){cacheInstance=utils.created(options,String(type))}else{cacheInstance=utils.created(options)}return cacheInstance},get:get,genOpenCfg:function(openCfg){console.log("::::genOpenCfg",openCfg);var _cfg={};$.each(openCfg,function(i,cfg){if($.inArray(cfg["filter"]||cfg.openFilterRules,i)>-1){if(i==="onload"){_cfg[i]=cfg[i]
}else{_cfg[i]=function(action){action?cfg[i](action):cfg[i]()}}}_cfg[i]=cfg[i]});return _cfg},open:function(openCfg){console.log(":::openCfg",openCfg);miniSupport("open")(openCfg)},genDepsIns:function(deps,flag){var _deps={};var deps=(deps&&deps.length>=0)?deps:[];var depsKey="";for(var d=0,dl=deps.length;d<dl;d++){depsKey=deps[d].key.split(".").join("");if(flag){_deps[depsKey]=utils.getInstance(deps[d])}else{_deps[depsKey]=utils.get(deps[d])}}return _deps},created:function(options,methodName){var _cacheEbapIns=null;if(typeof methodName==="string"&&methodName==="form"){_cacheEbapIns=miniSupport("form",options)}else{_cacheEbapIns=miniSupport("get")(options.id)}if(_cacheEbapIns){options["created"]&&typeof options["created"]==="function"&&options["created"](_cacheEbapIns)}return _cacheEbapIns},seekOptions:function(options,ins){for(var o in options){if(typeof options[o]==="function"){options[o](ins)}}},isAandHasCls:function(target,clsStr,strategy){return target.tagName==="A"&&$(target).hasClass(clsStr)&&clsStr===strategy},extendInjectRules:function(rule){if($.isPlainObject(rule)){for(var r in rule){if(rule.hasOwnProperty(r)){config.injectRules[r]=rule[r]}}return true}return false},eventProxy:_eventProxy,autoProxyTrigger:function(cfg,context){for(var icfg in cfg){if(cfg.hasOwnProperty(icfg)){this.eventProxy({context:context,cls:icfg,tagName:cfg[icfg].tagName,cb:cfg[icfg].cb})}}},getIns:function(){var insId=this.insId||"";var moduleType=this.moduleType;if(!insId){return this}return utils.getInstance({id:insId},moduleType)},setCommonCfg:function(obj,deep){var parseOBK=getAllOptions(obj);var cdArr=null;var cdLen=null;$.each(commonCfg.disable,function(index,cd){if(parseOBK(cd)!=null){cdArr=cd.split(".");cdLen=cdArr.length;if(cdLen===1){delete obj[cdArr[0]]}else{if(cdLen===2){delete obj[cdArr[0]][cdArr[1]]}else{if(cdLen===3){delete obj[cdArr[0]][cdArr[1]][cdArr[2]]}}}}});commonCfg=$.extend(deep?deep:true,commonCfg,obj)},getCommonCfg:function(){return commonCfg},hackIe:function(verStr,func){if($.inArray(verStr.split(" "),document.documentMode.toString())>-1){func.apply(null,nativeSlice.call(arguments).length>2&&nativeSlice.call(arguments,2))}},inject:function(options){return function(){config.injectRules[options.rule](options.mixin)}},extend:function(){var _extendObj={};$.each(Array.prototype.slice.call(arguments),function(i,arg){_extendObj=$.extend(_extendObj,arg)});$.extend(this,_extendObj);return this},getDictLabel:function getDictLabel(data,value,defaultValue){for(var i=0;i<data.length;i++){var ebapDictRows=data[i];if(ebapDictRows.value==value){return ebapDictRows.label}}return defaultValue},genParseOBK:function(opts){var parseOBK=opts.parseOBK;var _parseOBK=ebapUtils.getAllOptions(opts||{});return function(longPath,defaultValue){var _key=longPath.split(".").length>=2?longPath.split(".").slice(1).join("."):longPath.split(".").slice()[0]||"";console.log("::::key",_key,parseOBK(longPath,_parseOBK(_key,defaultValue)));return _parseOBK(_key,parseOBK(longPath,defaultValue))}},autoInput:autoInput,setUrls:function(obj){console.log(obj);if(toString.call(obj)==="[object Object]"){for(var ukType in obj){if(ukType.toLowerCase().slice(-3)==="url"){this.settings&&(this.settings[ukType]=utils.prefixPath(obj[ukType]))}else{this.settings&&(this.settings[ukType+"Url"]=utils.prefixPath(obj[ukType]))}}}},resetRoot:function(root){root&&(config["root"]=root)},encode:support("mini","encode")?support("mini","encode"):function(){},decode:support("mini","decode")?support("mini","decode"):function(){},clone:support("mini","clone")?support("mini","clone"):function(){},prefixPath:function(url,ctx){return typeof config.root!=="undefined"?config.root+(url||""):(url||"")},getModule:function(ns,ns_string){var parts=ns_string.split(".");var parent=ns;var pl=parts.length;var exportModule=null;for(var i=0;i<pl;i++){if(!exportModule){exportModule=parent[parts[i]]}else{exportModule=exportModule[parts[i]]}}return exportModule},ajax:function(options){var ajaxOpts=$.extend({contentType:"application/json",dataType:"json",cache:false,success:function(data,textStatus,jqXHR){options.success&&options.success(data,textStatus,jqXHR)},error:function(jqXHR,textStatus,errorThrown){options.error&&(options.error(jqXHR,textStatus,errorThrown))}},options);$.ajax(ajaxOpts)},actions:{close:function(action,ebapFormIns,context,data){if(action=="close"&&ebapFormIns.isChanged()){if(confirm("数据被修改了，是否先保存？")){return false}}if(window.CloseOwnerWindow){return window.CloseOwnerWindow(action)}else{window.close()}}},support:support,miniSupport:miniSupport};var ebapUtils=utils;function loginOut(url){if(winLocSearch.length===0&&win==win.parent){win.location.herf=utils.prefixPath(url)}else{if(winLocSearch.length===0&&win!=win.parent){win=win.top;win.location.reload()}}}var ebapLogin=function(options){var loginUrl=options.url||"/a/login";var self={out:function(){loginOut(loginUrl)}};return self};var ebapModal=function(options){var detailInfoState={cur:"0","0":"收起详情","1":"查看详情"};var tplCfg=$.extend({},{desc:"",detailInfo:""},options.tplCfg);
var modalState="show";var selector=options.selector||".ebap-maskContainer";var context=options.context||document;var defaultConfirmTpl=function(tplCfg){return('<div class="ebap-maskContainer">'+'<div class="ebap-modalCnt">'+'<div class="ebap-modal-tips"><div class="ebap-confirmSure ebap-modal-tipsCnt"><i class="fa fa-warning"></i>错误信息提示</div><button class="ebap-btn ebap-btn-warning ebap-modal-closeBtn"><i class="fa fa-power-off"></i>关闭</button></div>'+'<div class="ebap-modal-msgDesc ebap-modal-tipsCnt"><p class="ebap-modal-modalDescp">'+tplCfg.desc+"</p></div>"+'<div class="ebap-modal-msgDetail ebap-modal-msgDetailHidden"><h3 class="ebap-modal-errorTitle">详细信息</h3>'+ebapModal.getDetailInfo(tplCfg.detailInfo)+"</div>"+'<div class="ebap-modal-actions">'+'<button class="ebap-modal-confirmBtn ebap-btn ebap-btn-info"><i class="fa fa-info-circle"></i>查看详情</button></div></div>')};function clearMask(selector){selector.length>0&&selector.remove()}function insertModalNode(context,tplCnt,selector,func){if($("body",context).eq(0).find("script").length>0){$("body",context).eq(0).find("script").eq(0).before(tplCnt)}else{$("body",context).eq(0).append(tplCnt)}func(selector,context)}function activeDefaultAction(selector,context){$(selector+" .ebap-modal-closeBtn",context).click(function(event){$(selector,context).fadeOut();modalState="hide";return false});$(selector+" .ebap-modal-confirmBtn",context).click(function(event){$(selector+" .ebap-modal-msgDetail",context)[(detailInfoState.cur==="0"?"fadeIn":"fadeOut")](0);if(event.target.tagName.toLowerCase()==="i"){$(event.target).parent().html('<i class="fa fa-info-circle"></i>'+detailInfoState[detailInfoState.cur])}else{$(event.target).html('<i class="fa fa-info-circle"></i>'+detailInfoState[detailInfoState.cur])}detailInfoState.cur==="0"?detailInfoState.cur="1":detailInfoState.cur="0"})}function genConfirmModalCnt(tplCfg,selector,context){var tplCnt=defaultConfirmTpl(tplCfg);insertModalNode(context,tplCnt,selector,activeDefaultAction);$(selector+" .ebap-modal-detailCon",context).css({"height":(parseInt($(context).height()*0.48,10)-120)+"px"});window.top.onresize=function(){$(selector+" .ebap-modal-detailCon",context).css({"height":(parseInt($(context).height()*0.48,10)-120)+"px"})}}function showConfirmModal(tplCfg,selector,context){var $selector=$(selector,context);clearMask($selector);if($selector.length>0){modalState="show";$selector.fadeIn()}else{genConfirmModalCnt(tplCfg,selector,context)}}showConfirmModal(tplCfg,selector,context);return{show:function(){modalState="show";$(selector,context).fadeIn();return this},hide:function(){modalState="hide";$(selector,context).fadeOut();return this},getState:function(){return modalState}}};ebapModal.getDetailInfo=function(info){var _info=[];if(Object.prototype.toString.call(info)!=="[object Array]"){info=!info?[]:[info]}$.each(info,function(_,ifo){_info.push('<li><span class="ebap-modal-detailName">'+(ifo.name?ifo.name:"")+(ifo.description&&ifo.name?":":"")+'</span><span class="ebap-modal-detailDesc">'+(ifo.description?ifo.description:"")+"</li>")});return('<ol class="ebap-modal-detailCon">'+_info.join("")+"</ol>")};var ebapTabs=function(options){var ebapTabsIns=ebapUtils.getInstance(options.id);var _tabs=ebapTabsIns.getTabs();var _names=[];var self={addTab:function(tabCfg,ebapparams){var tabCfg=tabCfg||{};var self=this;if($.inArray(tabCfg.name,_names)>-1){var _activeTab=self.getTab(tabCfg.name);self.activeTab(_activeTab);return undefined}else{self._names.push(tabCfg.name);tabCfg.ondestroy=function(e){var _ebapTabs=e.sender;var _ebapIframe=_ebapTabs.getTabIFrameEl(e.tab);var pageReturnData=_ebapIframe.contentWindow.getData?_ebapIframe.contentWindow.getData():""};ebapTabsIns.addTab(tabCfg);self.activeTab(tabCfg);return self.getActiveTab()}},getActiveTab:function(){return ebapTabsIns.getActiveTab()},getTab:function(name){var __name=name;if(__name){return ebapTabsIns.getTab(__name)}return ebapTabsIns.getActiveTab()},updateTab:function(tab,tabCfg){ebapTabsIns.loadTab(tabCfg.url,tab);ebapTabsIns.updateTab(tab,tabCfg)},removeTab:function(name){var _name=name;var _activeTab=_name?self.getTab(_name):self.getActiveTab();if(_activeTab){ebapTabsIns.removeTab(_activeTab);self._names=self._names.splice($.inArray(_name,self._names),1)}},activeTab:function(name){ebapTabsIns.activeTab(_tabInstance.getTab(name))},on:function(event,func){ebapTabsIns.on(event,func)}};return self};var ebapForm=function(options){var ebapFormIns=ebapUtils.getInstance(options,"form");var ebapFormUrl="";var ebapFormData=null;this.ins=ebapFormIns;function _save(){ebapFormData=self.getData();var _treeSelect=ebapUtils.getInstance("parent-treeselect");ebapFormIns.validate();if(ebapFormIns.isValid()==false){return}ebapFormUrl=self.settings.saveUrl;ebapUtils.ajax({url:ebapFormUrl,type:"post",data:ebapUtils.encode(ebapFormData),success:function(data,textStatus,jqXhr){ebapUtils.actions.close("save",ebapFormIns)},error:function(jqXHR,textStatus,errorThrown){ebapUtils.actions.close("",ebapFormIns)
}})}var self={getData:function(formatter,deep){return ebapFormIns.getData(formatter,deep)},settings:{saveUrl:"",setUrl:""},labelModel:function(){var fields=ebapFormIns.getFields();for(var i=0,l=fields.length;i<l;i++){var c=fields[i];if(c.setReadOnly){c.setReadOnly(true)}if(c.setIsValid){c.setIsValid(true)}if(c.addCls){c.addCls("asLabel")}}},inputModel:function(){var fields=ebapFormIns.getFields();for(var i=0,l=fields.length;i<l;i++){var c=fields[i];if(c.setReadOnly){c.setReadOnly(false)}if(c.removeCls){c.removeCls("asLabel")}}miniSupport("repaint")(document.body)},setData:function(data,all,deep){ebapFormIns.setData(data,all,deep);if(data.action=="edit"){data=miniSupport("clone")(data);ebapFormUrl=self.settings.setUrl;ebapUtils.ajax({url:ebapFormUrl,data:{id:data.id},success:function(data,textStatus,jqXhr){ebapFormIns.setData(ebapUtils.decode(data));ebapFormIns.setChanged(false)}})}else{if(data.action=="new"){ebapFormIns.setData(data)}}},save:function(){ebapFormData=self.getData();var _treeSelect=ebapUtils.getInstance("parent-treeselect");ebapFormIns.validate();if(ebapFormIns.isValid()==false){return}ebapFormUrl=self.settings.saveUrl;ebapUtils.ajax({url:ebapFormUrl,type:"post",data:ebapUtils.encode(ebapFormData),success:function(data,textStatus,jqXhr){ebapUtils.actions.close("save",ebapFormIns)},error:function(jqXHR,textStatus,errorThrown){ebapUtils.actions.close("",ebapFormIns)}})},onOk:function(e){_save()},onCancel:function(e){ebapUtils.actions.close("cancel")}};return self};var ebapList=function(options){var defaultOptions={showHidden:[{id:1,text:"显示"},{id:0,text:"隐藏"}],openCfg:{width:600,height:400,edit:{title:"编辑菜单"},add:{title:'"新增菜单"'}}};var options=$.extend(defaultOptions,options);var showHidden=options.showHidden||"";var parseOBK=getAllOptions(options);var ebapTreeGridIns=ebapUtils.getInstance(options);var ebapSelectedRows=null;var data=null;options.loadData&&ebapTreeGridIns.reload();function getColumns(columns){columns=columns.clone();for(var i=columns.length-1;i>=0;i--){var column=columns[i];if(!column.field){columns.removeAt(i)}else{var c={header:column.header,field:column.field};columns[i]=c}}return columns}var self={renderers:{onShowHidenRenderer:function(e){for(var i=0,l=showHidden.length;i<l;i++){var g=showHidden[i];if(g.id==e.value){return g.text}}return""},onActionRenderer:function(){}},settings:{},onDrawCell:options.onDrawCell||function(){},exportAnything:function(opts){var columns=ebapTreeGridIns.getBottomColumns();var columns=getColumns(columns);var json=ebapUtils.encode(columns);document.getElementById("excelData").value=json;var excelForm=$("#excelForm");excelForm.submit()},add:function(opts){var deepParseOBK=self.genParseOBK($.extend(opts||{},{parseOBK:parseOBK}));ebapSelectedRows=ebapTreeGridIns.getSelected();data=parseOBK("openCfg.add.data",{action:"new",parentId:ebapSelectedRows&&(ebapSelectedRows.id||"")});var modeUrl=deepParseOBK("openCfg.add.mode.url")?ebapUtils.prefixPath(deepParseOBK("openCfg.edit.mode.url")):null;miniSupport("open")({url:modeUrl||self.settings.addUrl,title:deepParseOBK("openCfg.add.title","新增菜单"),width:deepParseOBK("openCfg.width",600),height:deepParseOBK("openCfg.height",400),onload:function(){var iframe=this.getIFrameEl();iframe.contentWindow.ebapForm.setData(data);deepParseOBK("openCfg.add.callback")&&deepParseOBK("openCfg.add.callback")(iframe.contentWindow,deepParseOBK)},ondestroy:function(action){ebapTreeGridIns.reload()}})},search:function(opts){var deepParseOBK=self.genParseOBK($.extend(opts,{parseOBK:parseOBK}));var _key=ebapUtils.getInstance(parseOBK("search.keywords","key")).getValue();deepParseOBK("search.ajax",function(opts){ebapTreeGridIns.load({key:opts.searchKey})})({searchKey:_key})},edit:function(opts){var deepParseOBK=self.genParseOBK($.extend(opts||{},{parseOBK:parseOBK}));ebapSelectedRows=ebapTreeGridIns.getSelected();data=deepParseOBK("openCfg.edit.data",{action:"edit",parentId:ebapSelectedRows&&(ebapSelectedRows.id||"")});var modeUrl=deepParseOBK("openCfg.edit.mode.url")?ebapUtils.prefixPath(deepParseOBK("openCfg.edit.mode.url")):null;if(ebapSelectedRows){if(miniSupport("open")){miniSupport("open")({url:modeUrl||self.settings.editUrl,title:deepParseOBK("openCfg.edit.title","编辑菜单"),width:deepParseOBK("openCfg.width",600),height:deepParseOBK("openCfg.height",400),onload:function(){var iframe=this.getIFrameEl();var data={action:"edit",id:ebapSelectedRows.id};iframe.contentWindow.ebapForm.setData(data);deepParseOBK("openCfg.edit.callback")&&deepParseOBK("openCfg.edit.callback")(iframe.contentWindow,deepParseOBK)},ondestroy:function(action){ebapTreeGridIns.reload()}})}}else{alert("请选中一条记录")}},remove:function(){ebapSelectedRows=ebapTreeGridIns.getSelecteds();if(ebapSelectedRows.length>0){if(confirm("确定删除选中记录？")){var ids=[];for(var i=0,l=ebapSelectedRows.length;i<l;i++){var r=ebapSelectedRows[i];ids.push(r.id)}var id=ids.join(",");ebapTreeGridIns.loading("操作中，请稍后......");utils.ajax({url:self.settings.delUrl+id,success:function(text){ebapTreeGridIns.reload()
},error:function(){}})}}else{alert("请选中一条记录")}}};return self};var builtInModules=builtInModules||{"form":ebapForm,"list":ebapList,"modal":ebapModal,"tabs":ebapTabs,"login":ebapLogin};for(var m in builtInModules){ebapModules[m]=builtInModules[m]||function(){}}function regesiter(moduleKey,module){if(moduleKey&&toString.call(moduleKey)=="[object Object]"){$.each(moduleKey,function(m,ms){m&&ms&&(ebapModules[m]=ms)})}else{var __moduleKey=moduleKey;__moduleKey&&($.inArray(typeof module,["function","object"])>-1)&&(ebapModules[__moduleKey]=module)}}function transformObjOrEmpty(obj){if(toString.call(obj)==="[object Object]"){return obj}return undefined}function get(options){var __moduleKey=options.key||"";var __moduleArr=[];var moduleLen=null;var moduleIns=null;var moduleDeps={};var moduleSettings={settings:{}};var returnModuleIns=null;options=$.extend({},commonCfg[__moduleKey]||{},options);var parseOBK=getAllOptions(options);var winMoudleName="";var originModuleSettings=parseOBK("settings",{});config.uiLib=parseOBK("uiLib",config.uiLib);$.each(originModuleSettings||{},function(m,ms){if(m.toLowerCase().slice(-3)==="url"){moduleSettings.settings[m]=utils.prefixPath(ms)}else{moduleSettings.settings[m+"Url"]=utils.prefixPath(ms)}});if(typeof __moduleKey=="string"){moduleDeps=utils.genDepsIns(options.deps);options=$.extend(true,options,{moduleDeps:moduleDeps});if(options.beforeCreate&&typeof options.beforeCreate==="function"){options=options.beforeCreate(options)||options}moduleIns=utils.getModule(ebapModules,options.key);returnModuleIns=$.extend(true,moduleIns($.extend({},options)),{setUrls:utils.setUrls,genParseOBK:utils.genParseOBK,getDepsIns:utils.getDepsIns,extend:utils.extend,getIns:utils.getIns,insId:options.id,moduleType:options.key,moduleDeps:moduleDeps},moduleSettings);if(!parseOBK("id")&&returnModuleIns){options["created"]&&typeof options["created"]==="function"&&options["created"](returnModuleIns)}if(options.mounted&&typeof options.mounted==="function"){if(transformObjOrEmpty(options.mounted(returnModuleIns))){returnModuleIns=$.extend({},returnModuleIns,transformObjOrEmpty(options.mounted(returnModuleIns)))}}if(options.name){winMoudleName="$"+(config.nameSpace+options.name).toUpperCase();while(window[winMoudleName]){winMoudleName="$"+winMoudleName}window[winMoudleName]=returnModuleIns}return returnModuleIns}else{if(toString.call(__moduleKey)==="[object Array]"){moduleLen=__moduleKey.length;for(var m=0;m<moduleLen;m++){if(__moduleKey[m]&&typeof __moduleKey[m]==="string"){moduleDeps=utils.genDepsIns(options.deps);options=$.extend(true,options,{moduleDeps:moduleDeps});if(options.beforeCreate&&typeof options.beforeCreate==="function"){options=options.beforeCreate(options)||options}moduleIns=utils.getModule(ebapModules,__moduleKey[m]);returnModuleIns=$.extend(true,moduleIns($.extend({},options,{moduleDeps:moduleDeps})),{setUrls:utils.setUrls,genParseOBK:utils.genParseOBK,getDepsIns:utils.getDepsIns,extend:utils.extend,getIns:utils.getIns,insId:options.id,moduleType:options.key,moduleDeps:moduleDeps},moduleSettings);if(!parseOBK("id")&&returnModuleIns){options["created"]&&typeof options["created"]==="function"&&options["created"](returnModuleIns)}if(options.mounted&&typeof options.mounted==="function"){if(transformObjOrEmpty(options.mounted(returnModuleIns))){returnModuleIns=$.extend({},returnModuleIns,transformObjOrEmpty(options.mounted(returnModuleIns)))}}if(options.name){winMoudleName="$"+(config.nameSpace+options.name).toUpperCase();while(window[winMoudleName]){winMoudleName="$"+winMoudleName}window[winMoudleName]=returnModuleIns}__moduleArr.push(returnModuleIns)}}return __moduleArr}}}function initGlobalEvent(){$(document).ajaxError(function(event,xhr,options,exc){if(xhr.status=="undefined"){return}var errorJson=support("mini","decode")(xhr.responseText);if(errorJson&&errorJson.ebaperror){var resJson={desc:errorJson.message,detailInfo:[{name:errorJson.detail,description:undefined}]};var customModal=utils.get({key:"modal",tplCfg:{desc:resJson.desc,detailInfo:resJson.detailInfo},selector:".ebap-maskContainer",context:document})}})}for(var u in utils){if(!($.inArray(u,config.enableList.lock)>-1)){utilsPool[u]=utils[u]}}(function init(){if(typeof ebapLogin==="function"){var ebapLoginIns=ebapLogin({url:"/a/login"});ebapLoginIns.out()}initGlobalEvent();if(!ebapInstance){ebapInstance={regesiter:regesiter,utils:utils,get:get,setUp:setUp};if(miniSupport("parse")&&!isParsed){isParsed=true;miniSupport("parse")()}}})();return ebapInstance})();var ebapUtils=ebapBase.utils;var ebapMiniSupport=ebapUtils.miniSupport;